<!DOCTYPE html>
<!-- saved from url=(0060)https://www.codeproject.com/KB/dialog/WindowInterceptor.aspx -->
<html lang="en"><script type="text/javascript" async="" src="./Window_Interceptor-CodeProject_files/analytics.js.download"></script><script async="false" type="module" src="chrome-extension://fiikommddbeccaoicoejoniammnalkfa/assets/inject.ts-C5uzPIY3.js"></script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	<link rel="preconnect" href="https://www.google-analytics.com/">

	<link rel="preconnect" href="https://www.codeproject.com/">


	<link rel="preload" href="./Window_Interceptor-CodeProject_files/logo250x135.gif" as="image">


	<link rel="preload" href="https://www.codeproject.com/App_Themes/CodeProject/Img/logo135-bg.gif" as="image">
	<link rel="preload" href="./Window_Interceptor-CodeProject_files/jquery-3.4.1.min.js.download" as="script" type="text/javascript">


	<title>Window_Interceptor-CodeProject</title> 
    
	<link type="text/css" rel="stylesheet" href="./Window_Interceptor-CodeProject_files/Article.min.css">


    <script type="text/javascript" src="./Window_Interceptor-CodeProject_files/jquery-3.4.1.min.js.download" defer=""></script>
<script type="text/javascript" src="./Window_Interceptor-CodeProject_files/article.min.js.download" defer=""></script>

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="Intercept, fill and close windows originated by third-party components hosted in C# application. As an encountered case, making WebBrowser control silent is considered.">
<meta name="Keywords" content="">
<meta name="Author" content="Sergey Stoyan">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">



<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 
<link rel="canonical" href="https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@CodeProject">
<meta name="og:site_name" content="CodeProject">
<meta name="twitter:creator" content="@CodeProject">
<meta property="og:type" content="article">
<meta property="article:published_time" content="3/3/2008 3:41:00 PM">
<meta property="article:modified_time" content="3/5/2008 5:08:00 AM">
<meta name="twitter:label1" content="Written by">
<meta name="twitter:data1" content="Sergey Stoyan">
<meta property="og:url" content="https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p">
<meta property="og:title" content="Intercept and Manage Windows Originated by Third-party Components Hosted in C# Application">
<meta property="og:description" content="Intercept, fill and close windows originated by third-party components hosted in C# application. As an encountered case, making WebBrowser control silent is considered.">


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="144x144" href="https://www.codeproject.com/favicon/apple-touch-icon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="https://www.codeproject.com/favicon/favicon-32x32.png"> 
<link rel="icon" type="image/png" sizes="16x16" href="https://www.codeproject.com/favicon/favicon-16x16.png"> 
<link rel="manifest" href="https://www.codeproject.com/favicon/manifest.json"> 
<link rel="mask-icon" href="https://www.codeproject.com/favicon/safari-pinned-tab.svg" color="#ff9900">
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p"
   },
  "name": "Intercept and Manage Windows Originated by Third-party Components Hosted in C# Application",
  "headline": "Intercept and Manage Windows Originated by Third-party Components Hosted in C# Application",
  "url": "https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p",
  "discussionUrl": "https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p#_comments",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/App_Themes/CodeProject/Img/Article100.png",
  "commentCount": "0",
  "editor" : {
    "@type" : "Person",
    "name" : "Editor",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Intercept, fill and close windows originated by third-party components hosted in C# application. As an encountered case, making WebBrowser control silent is considered.",
  "author" : [{
      "@type" : "Person",
      "name" : "Sergey Stoyan",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=2323668"
    }],
  "datePublished": "2008-03-03",
  "dateCreated": "2008-03-03",
  "dateModified": "2008-03-05"
}</script>




	<!--<base target="_top">--><base href="." target="_top">
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="./Window_Interceptor-CodeProject_files/js"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'UA-1735123-1' , {'user_id': 'f5181905-696e-4313-a52b-2dd04b34504d'});
    </script>

<style type="text/css"></style></head>	

<body class="edge edge136">



<a class="access-link" href="https://www.codeproject.com/KB/dialog/WindowInterceptor.aspx#Main"><img alt="Click here to Skip to main content" src="./Window_Interceptor-CodeProject_files/t.gif"></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed narrow">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">65,938 articles</div>
	
	<div id="ctl00_MemberBar_ChangeNotice" class="flex-item align-left">CodeProject
	is changing. <a href="https://www.codeproject.com/info/Changes.aspx">Read more</a>.</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed narrow">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Window_Interceptor-CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"></div>
        </div>
    </div>

	
			
	

	<div id="A" class="container-content-wrap fixed narrow"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
&nbsp;










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p?display=Print" class="tooltip" title="">
   <img src="./Window_Interceptor-CodeProject_files/print48.png" width="24" height="24" style="border:0">
<div class="speech-bubble-container-up" style="width:auto">  <div class="speech-bubble-up" style="text-align:center"> Print</div>  <div class="speech-bubble-pointer-up">    <div class="speech-bubble-pointer-up-inner"></div>  </div></div></a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    
            

			
			<div id="AT" class="article-container  fixed narrow" style="max-width:inherit;"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/KB/dialog/View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="p0rTLiRVxcfw7psn15XaQm036Dju9Jprit7CWwogcpuSslD25oPKLK6IGb1hikUAvY3j1wBTHIG7wjYL1Fh0qKwoMXGPcRF2NapjHgogUUi1xAXgSBTYsa7y6kftTz6nDO4GBtR3gmQJeJ2D3kOS3AahLxZfl253pzhx+YH8ImNIMSp2FttiwsDrrcjOraIG1w5gkhO6AREPiNz73I7i/i10ufmOTgmIk8QYnRKKu55mLQwvm5Xa6bZE7D2ZKxK4MsHqx5fZunudjmsfVyFeJ0Ls16Jr4vX4iHaZzb4RuGWjphxTNkKP+JZ7KQ0py4GacfQJ5OXwZAt5WJ8qBw8qZd0GOTEqlF1Nj/UpAufaWOgJGeis9jqaXnh5+5GUe/Mv0fivkC3hHT7/W9GPb2RRl9jOobowWYELumJYNK38wOrwDatDM5HvvuiR0Q9ZTjg1zwHTYrN4rb06p39tobKwYyRzxgj5DSbSsxwLD5cKsWZyUo04tmTHJ1WrQD4ig6FRL5dZGVlUwL8c4uRT0xtwz5/NqXGUrclVbxxbqnfNmsqlFZqvKHH3rB5VzqnVs3wfLI9esGo6/KvlAm15PA3GrlE313tKnTM2L4VHjm0gxRFo/34/GvyuItg84eVd3ZsTTph0lwGkBy6yLcwFSQz4F+7Djcvc1V/xCT41sxJlaePOSt+EV5HgC5ofo2ZBJNflzik/Ek2d5zL0/hqq3zpycBQFl2AmHJvfKZxHg+iWx4T2jco+bR+DEl9X/8DpcS3/cCCYnGqWuGffKyuH2HyMkHG+jylmHzwlMkvZ9FJTJyFpvor1cPjSx+sLh4o133P92NOVTwdbyLw0XqzmKqB7qT+b8uPpiMcHgHM4k0Z9aoLeA0iNiknBBQ0m8wF1OFgOUif+rMu0nrBVhEIpUesNmErTM/MYuBJiYnsnoP8iYKbRldACwujRqwhAgGBLeP+dzB4SuYg/sBfG62zZKe2DWsVFZSBRxkykasHMmaUcyFqpqbN2j5UUpEr1OBAiekgTz5gTAak2HEEYrNDgaSNavjKpZNlth377jNT/sBipKULFUZ/rixV1ZNKEMWfDMBYHNPHkRmP3Rmf/VsxSxFvPBPK+W2nonCWgo+fO6Rc+Zr6dFfrq9zUAPVL7Zng3jBV0gZDu8WuHBKSvOztoLAqpmy31jqDM8k/83ap2M1Qk2rkhalI+OkSXZuXXvkO5g2g6ny7F3yL/v1QcKMQ4zZOQUhiZhDGzqeB7aCHaP6whlRVRUrz9pGnByYLHkaCYQParHHeWcejh7cukbkcGga5LDEeW7vdKt6PZWUuLYlwmvA6FHvmbWJiABGRVJsJUb6lGXho7OJYfVZa5B2uRdYANDjwbpzMkbOlfdxxN8DgqSM1+lTwAWRyiSMWp8N9bSQiM+mQJQhcPq3twVpJ1ZEelhlwGKjwdLw+M6NalG49NyD5uYJJRZkORero4hpHb5WiU4kUssE93IaaQ0RwEyxieYuCyRfxBSBxhaqUM3JZ7ywLI89SkwRhVteuypC3VukE3JgQc+WOgffmdwoNMlZsEsQPDyqLv37QKETcSBR1UOi2HpXe9wLXPNBnkSVZ7j20//liODggcvXp2xtnMgYFK8gN1r33BWDQ7NknXpXrlZh4vnfJtCyNFpNglh9dWf9mMWLP9U7Q0rmHGa3WRbBmoNLiJB07hV7l/yR9ur6zmpbXBnm23ABz+uWo2qdWxooSFq/Mye4yBVcRaVofK+WB+s/Pi2CWkCWBX9LXaLF1QkB23KINV/8QTAO2Otxc+7DdUEmaciQuPmks7WJZcvXD6pZvX7Ts=">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>
					    <a name="_articleTop" id="_articleTop"></a>

					    
						<div>
							<span id="ctl00_TagListHorz_TagWrp">

	
	

	
	<span id="ctl00_TagListHorz_VisibleTags" class="subdue">(untagged)</span> 

	
	
</span>


						</div>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Intercept and Manage Windows Originated by Third-party Components Hosted in C# Application</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=2323668" rel="author">Sergey Stoyan</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_24066">

	<meta itemprop="upvoteCount" content="0">


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		

		
		<div class="nowrap tooltip">

			
			<div id="ctl00_RateArticle_ResultNoHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div style="width:24px;position:relative" class="clipped"><img src="./Window_Interceptor-CodeProject_files/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0"></div><div><img src="./Window_Interceptor-CodeProject_files/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Window_Interceptor-CodeProject_files/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Window_Interceptor-CodeProject_files/star-empty-lg.png" style="width:24px;height:24px"></div><div><img src="./Window_Interceptor-CodeProject_files/star-empty-lg.png" style="width:24px;height:24px"></div></div></div>
			

			
			

			
            

			
                

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">0.00/5  (No votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container" style="color:#666;font-size:smaller">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">4 Mar 2008</span><span id="ctl00_HorizontalStats" class="stats flex-item-tight"><span class="stats"><span title="Views"><img src="./Window_Interceptor-CodeProject_files/views32.png" style="width:16px"> 1</span> &nbsp; </span></span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Intercept, fill and close windows originated by third-party components hosted in C# application. As an encountered case, making WebBrowser control silent is considered.</div><span id="ctl00_ThumbnailUrl" class="date" content="https://www.codeproject.com/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<!-- Article Starts -->


<ul class="download">
<li><a href="https://www.codeproject.com/KB/dialog/WindowInterceptor/WindowInterceptor.zip">Download source - 48.14 KB</a> </li>
</ul>
<img height="394" alt="Sample Image - maximum width is 600 pixels" hspace="0" src="./Window_Interceptor-CodeProject_files/error1.jpg" width="587" border="0"> 
<h2>Introduction</h2>

<p>Sometimes you may collide with the following problem: a third-party binary component or control embedded into your application displays windows (usually message boxes) that hang your code until they are closed. <br>If you do not have the source code of this binary and one does not have a good API to change one’s bad behaviour programmatically, it can be a real headache using the one. A famous example of such a binary is the <code>WebBrowser</code> control in .NET. </p>

<p>The following types of problems can occur: </p>

<ul>
<li>The component used in your code throws a pile of error messages and makes the user struggle through them to get the application working further. It is probably the most annoying case. </li>

<li>The component displays a dialog box and waits for data entered there. </li>
</ul>

<p>In both these cases, your code execution is suspended and exasperating windows appear on the desktop while you may want your code to work smoothly and silently without stumbling and the need of human intervention. </p>

<p>To solve these problems, you have to manage such windows from your code: close them, or even fill them with data and submit.</p>

<h2>Important Notes</h2>

<p>In this article, we consider managing windows originated by the <code>WebBrowser</code> control embedded into your application. It is a relatively common case. But actually the solution considered in this article can be applied to any control or binary used by your process. </p>

<p>The code is C#, but it consists of Win32 functions imported via interop. So actually the solution is in C++ and the attached code can be easily translated to C++ if it is needed. </p>

<h2>Dialogs Opened by WebBrowser</h2>

<p>Using <code>WebBrowser</code> control, you may face the following challenge: Web page downloaded by <code>WebBrowser</code> contains JavaScript which throws an error message. It is one of the reasons why <code>WebBrowser</code> can show a message box. A dialog box may also appear when the browser asks what to do with the navigated file: open or save. The browser can also ask for credentials or throw a security alert, etc. </p>

<p>The problem is that if such a dialog box is opened, <code>WebBrowser</code> object cannot be navigated to the next page and remains paralysed until the dialog is closed. Let’s see how it can be solved programmatically. </p>

<h2>Solution</h2>

<p>We'll follow a most plump and reliable way for our task that consists of the following steps: </p>

<ul>
<li>Intercepting Windows messages that correspond to window creation</li>

<li>Getting a handle of the window that must be managed</li>

<li>Closing the window or filling and submitting it (clicking OK)</li>
</ul>

<h2>Intercept Dialog Windows</h2>

<p>The first thing that we have to do is monitor window creation from our code. <br>This can be done through Win32 API function <code>SetWindowsHookEx</code> that will invoke our callback method. This function can trace several events in Windows including creation of a window. To do it, we'll invoke it with flag <code>WH_CALLWNDPROCRET</code> that installs a hook procedure that monitors messages after they have been processed by the destination window procedure. </p>

<p>Each time as our callback function is invoked, we only have to filter message <code>WM_SHOWWINDOW</code> message that is sent to a window when the window is about to be hidden or shown. <br>Please look at the code below to realize the rest: </p>

<div class="pre-lang" id="premain186297"><div>C#</div><div class="pre-action-link"><span class="code-collapse" data-index="186297" id="preShrink186297">Shrink ▲</span> &nbsp; <span class="copy-code" data-index="186297" id="copycode186297" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre186297" style="margin-top: 0px;" class="notranslate"><span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
<span class="code-SummaryComment">///</span><span class="code-comment"> Intercept creation of window and call a handler</span>
<span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">class</span> WindowInterceptor
{
    <span class="code-SDKkeyword">IntPtr</span> hook_id = <span class="code-SDKkeyword">IntPtr</span>.Zero;

    Win32.Functions.HookProc cbf;

    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> Delegate to process intercepted window</span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">param</span> <span class="code-SummaryComment">name="hwnd"</span><span class="code-SummaryComment">&gt;</span><span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">param</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-keyword">public</span> <span class="code-keyword">delegate</span> <span class="code-keyword">void</span> ProcessWindow(<span class="code-SDKkeyword">IntPtr</span> hwnd);
    ProcessWindow process_window;

    <span class="code-SDKkeyword">IntPtr</span> owner_window = <span class="code-SDKkeyword">IntPtr</span>.Zero;

    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> Start dialog box interception for the specified owner window</span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">param</span> <span class="code-SummaryComment">name="owner_window"</span><span class="code-SummaryComment">&gt;</span>owner window; if IntPtr.Zero,</span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> any windows will be intercepted<span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">param</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">param</span> <span class="code-SummaryComment">name="process_window"</span><span class="code-SummaryComment">&gt;</span>custom delegate to process intercepted window</span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">param</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-keyword">public</span> WindowInterceptor(<span class="code-SDKkeyword">IntPtr</span> owner_window, ProcessWindow process_window)
    {
        <span class="code-keyword">if</span> (process_window == <span class="code-keyword">null</span>)
            <span class="code-keyword">throw</span> <span class="code-keyword">new</span> Exception(<span class="code-string">"</span><span class="code-string">process_window cannot be null!"</span>);
        <span class="code-keyword">this</span>.process_window = process_window;

        <span class="code-keyword">this</span>.owner_window = owner_window;

        cbf = <span class="code-keyword">new</span> Win32.Functions.HookProc(dlg_box_hook_proc);
        <span class="code-comment">//</span><span class="code-comment">notice that win32 callback function must be a global variable within class</span>
        <span class="code-comment">//</span><span class="code-comment">to avoid disposing it!</span>
        hook_id = Win32.Functions.SetWindowsHookEx(Win32.HookType.WH_CALLWNDPROCRET,
                 cbf, <span class="code-SDKkeyword">IntPtr</span>.Zero, Win32.Functions.GetCurrentThreadId());
    }

    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> Stop intercepting. Should be called to calm unmanaged code correctly</span>
    <span class="code-SummaryComment">///</span><span class="code-comment"> <span class="code-SummaryComment">&lt;</span><span class="code-SummaryComment">/</span><span class="code-SummaryComment">summary</span><span class="code-SummaryComment">&gt;</span></span>
    <span class="code-keyword">public</span> <span class="code-keyword">void</span> Stop()
    {
        <span class="code-keyword">if</span> (hook_id != <span class="code-SDKkeyword">IntPtr</span>.Zero)
            Win32.Functions.UnhookWindowsHookEx(hook_id);
        hook_id = <span class="code-SDKkeyword">IntPtr</span>.Zero;
    }

    ~WindowInterceptor()
    {
        <span class="code-keyword">if</span> (hook_id != <span class="code-SDKkeyword">IntPtr</span>.Zero)
            Win32.Functions.UnhookWindowsHookEx(hook_id);
    }

    <span class="code-keyword">private</span> <span class="code-SDKkeyword">IntPtr</span> dlg_box_hook_proc(<span class="code-keyword">int</span> nCode, <span class="code-SDKkeyword">IntPtr</span> wParam, <span class="code-SDKkeyword">IntPtr</span> lParam)
    {
        <span class="code-keyword">if</span> (nCode &lt; <span class="code-digit">0</span>)
            <span class="code-keyword">return</span> Win32.Functions.CallNextHookEx(hook_id, nCode, wParam, lParam);

        Win32.CWPRETSTRUCT msg = (Win32.CWPRETSTRUCT)Marshal.PtrToStructure
            (lParam, <span class="code-keyword">typeof</span>(Win32.CWPRETSTRUCT));

        <span class="code-comment">//</span><span class="code-comment">filter out create window events only</span>
        <span class="code-keyword">if</span> (msg.message == (<span class="code-keyword">uint</span>)Win32.Messages.WM_SHOWWINDOW)
        {
            <span class="code-keyword">int</span> h = Win32.Functions.GetWindow(msg.hwnd, Win32.Functions.GW_OWNER);
            <span class="code-comment">//</span><span class="code-comment">check if owner is that is specified</span>
            <span class="code-keyword">if</span> (owner_window == <span class="code-SDKkeyword">IntPtr</span>.Zero || owner_window == <span class="code-keyword">new</span> <span class="code-SDKkeyword">IntPtr</span>(h))
            {
                <span class="code-keyword">if</span> (process_window != <span class="code-keyword">null</span>)
                    process_window(msg.hwnd);
            }
        }

        <span class="code-keyword">return</span> Win32.Functions.CallNextHookEx(hook_id, nCode, wParam, lParam);
    }
}</pre>

<p>Pay attention to one <strong>important thing</strong>: we filter only those messages that are addressed to windows owned by certain window. It is a trick needed since our own code can open windows as well and we do not want them to be intercepted and closed automatically. All windows originated by a control (in our case <code>WebBrowser</code>) will be owned by default by the form where they are placed. Thus window’s owner is a way to distinguish windows opened by <code>WebBrowser </code>from the rest of the windows opened by our code. Notice, to have this working, we should assign another owner to our own windows. <br>Another way to distinguish the unneeded windows from yours is filtering them by their caption text. Caption of a window can be obtained by Win32 function <code>GetWindowText</code>. It is also a good way since usually you know in advance what captions your windows will have.</p>

<p>Also remember a callback function (in the code <code>Win32.Functions.HookProc cbf</code>) invoked from unmanaged code must be a global variable within the class to avoid disposing.</p>

<p>Each time as the owner of the intercepted window is the specified one, the callback function invokes a delegate method where we defined how to treat the intercepted window, and passes the window’s handle to it. </p>

<h2>Manage Window by Handle</h2>

<p>Great! Having obtained a handle of the window, we can do what we want with it. </p>

<h3>Close Dialog</h3>

<p>To demo the ability we have now, I created a form where <code>WebBrowser </code>is placed and also a small HTML page with JavaScript. Upon loading this form, <code>WebBrowser </code>is navigated to this page: </p>

<div class="pre-lang" id="premain883213"><div>ASP.NET</div><div class="pre-action-link"><span class="copy-code" data-index="883213" id="copycode883213" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="aspnet" data-codeblock-processed="true" id="pre883213" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">&lt;</span><span class="code-leadattribute">HTML</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">BODY</span><span class="code-keyword">&gt;</span>

HERE IS STUMBLING PAGE...

<span class="code-keyword">&lt;</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>
ERROR HERE!
<span class="code-keyword">&lt;/</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>

<span class="code-keyword">&lt;</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>
alert(<span class="code-string">"</span><span class="code-string">Error"</span>);
<span class="code-keyword">&lt;/</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>

<span class="code-keyword">&lt;</span><span class="code-leadattribute">br</span><span class="code-keyword">&gt;</span>OK NOW!

<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">BODY</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">HTML</span><span class="code-keyword">&gt;</span></pre>

<p>It will force our <code>WebBrowser </code>to display an alert message and suspend <code>WebBrowser </code>until the alert box is closed. </p>

<p>We want to close it from our code? No problem now. To do it, we create <code>WindowInterceptor</code> instance and pass a window handler delegate to it: </p>

<div class="pre-lang" id="premain946186"><div>C#</div><div class="pre-action-link"><span class="copy-code" data-index="946186" id="copycode946186" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre946186" style="margin-top: 0px;" class="notranslate"><span class="code-comment">//</span><span class="code-comment">form with WebBrowser</span>
Form1 form = <span class="code-keyword">new</span> Form1();
<span class="code-comment">//</span><span class="code-comment">Start intercepting all dialog boxes owned by form</span>
WindowInterceptor d = <span class="code-keyword">new</span> WindowInterceptor(form.Handle, ProcessWindow1);
form.Show();
form.Navigate(<span class="code-string">"</span><span class="code-string">http://localhost/test1.htm"</span>);</pre>

<p>This is the window handler that will close a dialog window: </p>

<div class="pre-lang" id="premain985836"><div>C#</div><div class="pre-action-link"><span class="copy-code" data-index="985836" id="copycode985836" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre985836" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">static</span> <span class="code-keyword">void</span> ProcessWindow1(<span class="code-SDKkeyword">IntPtr</span> hwnd)
{
    <span class="code-comment">//</span><span class="code-comment">close window</span>
    Win32.Functions.SendMessage(hwnd, (<span class="code-keyword">uint</span>)Win32.Messages.WM_CLOSE, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
}</pre>

<p>That’s all about how to shut up <code>WebBrowser </code>in a simple and elegant manner. </p>

<h3>Submit Dialog</h3>

<p>Now let’s consider a more complex case: when you need to click a certain button in the intercepted window. For demo purposes, I created another HTML: </p>

<div class="pre-lang" id="premain185004"><div>ASP.NET</div><div class="pre-action-link"><span class="copy-code" data-index="185004" id="copycode185004" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="aspnet" data-codeblock-processed="true" id="pre185004" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">&lt;</span><span class="code-leadattribute">HTML</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">BODY</span><span class="code-keyword">&gt;</span>

HERE IS STUMBLING PAGE #2...

<span class="code-keyword">&lt;</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">if</span>(confirm(<span class="code-string">"</span><span class="code-string">Do you really want to go here?"</span>))
  navigate(<span class="code-string">"</span><span class="code-string">http://www.google.com"</span>);
<span class="code-keyword">&lt;/</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>

<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">BODY</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">HTML</span><span class="code-keyword">&gt;</span></pre>

<p>Assume we want to click “OK” in this confirm dialog. The code below does it: </p>

<div class="pre-lang" id="premain367386"><div>C#</div><div class="pre-action-link"><span class="copy-code" data-index="367386" id="copycode367386" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre367386" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">static</span> <span class="code-keyword">void</span> ProcessWindow2(<span class="code-SDKkeyword">IntPtr</span> hwnd)
{
    <span class="code-comment">//</span><span class="code-comment">looking for button "OK" within the intercepted window</span>
    <span class="code-SDKkeyword">IntPtr</span> h =
        (<span class="code-SDKkeyword">IntPtr</span>)Win32.Functions.FindWindowEx(hwnd, <span class="code-SDKkeyword">IntPtr</span>.Zero, <span class="code-string">"</span><span class="code-string">Button"</span>, <span class="code-string">"</span><span class="code-string">OK"</span>);
    <span class="code-keyword">if</span> (h != <span class="code-SDKkeyword">IntPtr</span>.Zero)
    {
        <span class="code-comment">//</span><span class="code-comment">clicking the found button</span>
        Win32.Functions.SendMessage
                ((<span class="code-SDKkeyword">IntPtr</span>)h, (<span class="code-keyword">uint</span>)Win32.Messages.WM_LBUTTONDOWN, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
        Win32.Functions.SendMessage
                ((<span class="code-SDKkeyword">IntPtr</span>)h, (<span class="code-keyword">uint</span>)Win32.Messages.WM_LBUTTONUP, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
    }
}</pre>

<h3>Fill Controls Within Dialog</h3>

<p>If certain fields within a dialog need to be filled with data (say login and password), they can be set by Win32 function <code>SetWindowText</code>. Handles of needed controls can be found in the same manner as we found the button “OK”. <br>Some controls like dropdown box do not have a text caption that could help us to find them. Instead of it, handles of such controls can be found by its class names passed to <code>FindWindowEx</code>. <br>But how do we find out their class names or captions that are hidden? To do it easily, use helpful tools like VS Spy++ or Winspector – they can display all information about controls hosted within a certain window.</p>

<p>This code looks for an edit box within an intercepted window and fills it with text:</p>

<div class="pre-lang" id="premain459224"><div>C#</div><div class="pre-action-link"><span class="copy-code" data-index="459224" id="copycode459224" style="visibility: visible;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 460 460" style="width: 16px;height:16px;" xml:space="preserve">
<g>
<path d="M425.934,0H171.662c-18.122,0-32.864,14.743-32.864,32.864v77.134h30V32.864c0-1.579,1.285-2.864,2.864-2.864h254.272
    c1.579,0,2.864,1.285,2.864,2.864v254.272c0,1.58-1.285,2.865-2.864,2.865h-74.729v30h74.729
    c18.121,0,32.864-14.743,32.864-32.865V32.864C458.797,14.743,444.055,0,425.934,0z"></path>
<path d="M288.339,139.998H34.068c-18.122,0-32.865,14.743-32.865,32.865v254.272C1.204,445.257,15.946,460,34.068,460h254.272
    c18.122,0,32.865-14.743,32.865-32.864V172.863C321.206,154.741,306.461,139.998,288.339,139.998z M288.341,430H34.068
    c-1.58,0-2.865-1.285-2.865-2.864V172.863c0-1.58,1.285-2.865,2.865-2.865h254.272c1.58,0,2.865,1.285,2.865,2.865v254.273h0.001
    C291.206,428.715,289.92,430,288.341,430z"></path>	
</g>
</svg></span></div></div><pre lang="cs" data-codeblock-processed="true" id="pre459224" style="margin-top: 0px;" class="notranslate"><span class="code-keyword">static</span> <span class="code-keyword">void</span> ProcessWindow3(<span class="code-SDKkeyword">IntPtr</span> hwnd)
{
    <span class="code-comment">//</span><span class="code-comment">looking for edit box control within intercepted window</span>
    <span class="code-SDKkeyword">IntPtr</span> h =
        (<span class="code-SDKkeyword">IntPtr</span>)Win32.Functions.FindWindowEx(hwnd, <span class="code-SDKkeyword">IntPtr</span>.Zero, <span class="code-string">"</span><span class="code-string">Edit"</span>, <span class="code-keyword">null</span>);
    <span class="code-keyword">if</span> (h != <span class="code-SDKkeyword">IntPtr</span>.Zero)
    {
        <span class="code-comment">//</span><span class="code-comment">setting text</span>
                Win32.Functions.SetWindowText((<span class="code-SDKkeyword">IntPtr</span>)h, <span class="code-string">"</span><span class="code-string">qwerty"</span>);
    }
    <span class="code-comment">//</span><span class="code-comment">looking for button "OK" within the intercepted window</span>
    <span class="code-SDKkeyword">IntPtr</span> h = (<span class="code-SDKkeyword">IntPtr</span>)Win32.Functions.FindWindowEx(hwnd, <span class="code-SDKkeyword">IntPtr</span>.Zero, <span class="code-string">"</span><span class="code-string">Button"</span>, <span class="code-string">"</span><span class="code-string">OK"</span>);
    <span class="code-keyword">if</span> (h != <span class="code-SDKkeyword">IntPtr</span>.Zero)
    { <span class="code-comment">//</span><span class="code-comment">clicking the found button</span>
        Win32.Functions.SendMessage
            ((<span class="code-SDKkeyword">IntPtr</span>)h, (<span class="code-keyword">uint</span>)Win32.Messages.WM_LBUTTONDOWN, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
        Win32.Functions.SendMessage
                ((<span class="code-SDKkeyword">IntPtr</span>)h, (<span class="code-keyword">uint</span>)Win32.Messages.WM_LBUTTONUP, <span class="code-digit">0</span>, <span class="code-digit">0</span>);
    }
    <span class="code-keyword">else</span>
    { <span class="code-comment">//</span><span class="code-comment">close window if OK was not found</span>
        Win32.Functions.SendMessage(hwnd, (<span class="code-keyword">uint</span>)Win32.Messages.WM_CLOSE, <span class="code-digit">0</span>, <span class="code-digit">0</span>); }
    }
}</pre>

<h2>Some Remarks</h2>

<p>Sure, these samples are done for test purposes only. In real life, this approach helped me to play around two tasks: making <code>WebBrowser</code> silent and submitting credential dialog that appears before logging into a site so that <code>WebBrowser</code> was quite automated. </p>

<p>To be complete, the cases considered above could also be solved in other ways (any problem has more than one solution). Some of them can be solved by embedding self-written JavaScript into a downloaded page. Some of them can be solved by changing Internet Explorer user settings in registry. Credential dialog can be avoided by setting credentials using Internet Explorer API within our code, etc. But these ways are narrow and serve only special cases while the considered solution does not depend on third-party software used and so allows writing a reliable and simple code. BTW, in view of <code>WebBrowser</code>, as far as I investigated this problem, even using Internet Explorer API (a number of intricate interfaces) there is no way to suppress dialog boxes that the browser can throw in some cases. </p>

<p>Moreover, the behaviour of a control may be different from version to version. As a case of version incompatibility, you may draw attention to <code>WebBrowser</code>’s property <code>Silent</code>. I suppose it worked years ago in some Internet Explorer versions but seems not to be working under WinXP+SP2 with Internet Explorer 6. As a result, the app developed with confidence in this property may face a problem when Internet Explorer on the machine is upgraded. </p>

<h2>Conclusion</h2>

<p>The described solution can be successful when you have no civil way to settle windows originated by third-party components. In addition, it may have the following advantages before using the API of such components (if they have an API at all): </p>

<ul>
<li>It is simple</li>

<li>It is reliable</li>

<li>It does not depend on different versions of third-party software</li>

<li>It keeps third-party software settings unchanged</li>
</ul>

<h2>Using the Code</h2>

<p>In the attached code, you can find: </p>

<ul>
<li>The class <code>WindowInterceptor</code> that monitors appearing dialog windows and calls a custom delegate method. This class can be used as a DLL from your code. </li>

<li><code>Test</code> project with <code>WebBrowser</code> control</li>

<li><em>test1.html</em> and <em>test2.html</em> with JavaScript. Do not forget to place them to your <em>www</em> directory and specify their URL in the <code>Test</code> project. </li>
</ul>

<p>Be happy! </p>



<!-- Article Ends -->


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article has no explicit license attached to it but may contain usage terms in the article text or the download files themselves. If in doubt please contact the author via the discussion board below.</p><p>A list of licenses authors might use can be found <a href="https://www.codeproject.com/info/Licenses.aspx">here</a></p></div>
						

						
						<br>
						
						    <br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    
				</div>
				
                
                

				
				
				

			</div>
			

            
            
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/24066/Intercept-and-Manage-Windows-Originated-by-Third-p">Permalink</a><br>
				<br>
				<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a><br>
    			<a id="ctl00_CookiePolicyLink" href="https://www.codeproject.com/info/cookie.aspx">Cookies</a><br>
                <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a><br>
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/KB/dialog/WindowInterceptor.aspx?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/KB/dialog/WindowInterceptor.aspx?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br>
			</div>
                
			<div class="align-right">
				Article Copyright 2008 by Sergey Stoyan<br>Everything else
				Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2025<br>
                <br>
				Web01 
				2.8:2024-12-08:1<br>
			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div> 
</div>







<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');

})
</script>










<style type="text/css">.copied::after {  position: absolute;  right: 0;  display: inline-block; white-space: nowrap; content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 8px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; } 70% { opacity: 1; } 100% { opacity: 0; } } </style><canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas></body></html>